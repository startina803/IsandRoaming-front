import{$ as Q,a0 as W,z as v,C as X,ae as Y,a9 as d,a4 as a,a1 as Z,a3 as r,c as s,a2 as c,af as x,aa as V,a6 as i,b as l,ah as z,ab as u,ag as j,a7 as y,a8 as b,V as F,U as L,au as N,aj as ee,ak as te,am as ae,an as se}from"./index-DT9_2KCU.js";import{i as R}from"./invitation-Nm8-ZbY7.js";import{j as le}from"./job-B_bayAxe.js";import{r as oe}from"./resume-uIzL9sNq.js";import{_ as re,V as J,a as D}from"./_plugin-vue_export-helper-Cq28cyYG.js";import{V as ne}from"./VContainer-Dn3bCXe2.js";import{V as ie}from"./VAlert-DmkpoVwJ.js";import{V as A,a as E}from"./VCarouselItem-3Spelysp.js";import{V as ue}from"./VTooltip-CLVdsNUX.js";import{V as G}from"./VDivider-Dm6exH0k.js";import{a as h,V as w}from"./VChip-Mae0U7qf.js";import{V as de}from"./VTextarea-C6-JuJcs.js";import"./ssrBoot-CPM_QtVF.js";const ce={key:0,class:"text-center pa-12"},me={class:"text-center mt-6"},ve={class:"text-h4 font-weight-bold text-primary mb-2"},fe={class:"text-h6 text-grey-darken-1"},pe={key:0,class:"mb-6"},_e=["href"],ge={class:"resume-section"},ye={class:"resume-section"},be={class:"resume-section"},ke={key:1,class:"resume-section"},xe={class:"text-body-1"},Ve={class:"resume-section"},he={class:"text-body-1"},we={class:"resume-section"},Ie={class:"text-body-1",style:{"white-space":"pre-wrap"}},Ce={class:"resume-section"},Be={class:"text-body-1"},Pe={class:"resume-section"},Se={class:"resume-section"},Ue={key:0,class:"mb-4"},Te={class:"text-primary"},je={key:1,class:"text-center"},Le={__name:"[id]",setup(De){const B=Y(),M=Z(),P=Q(),k=W(),o=v(null),S=v(!0),I=v(null),f=v(!1),p=v(!1),U=v(null),_=v(""),g=v(!1),C=v(!1),T=v(0),q=m=>{T.value=m,C.value=!0},H=async()=>{var m,e;if(!P.isLoggedIn){M.push("/login");return}f.value=!0,p.value=!0;try{const{data:t}=await le.getMyJobs(),n=t.result.filter($=>$.status==="open");if(n.length===0){k({text:"您沒有已刊登且開放中的工作，無法發送邀請。",snackbarProps:{color:"error"}}),f.value=!1;return}U.value=n[0]._id,_.value=`您好，我們是「${P.nickname}」，誠摯邀請您來我們的旅宿打工換宿！`}catch(t){console.error("Failed to load host jobs:",t);const n=((e=(m=t.response)==null?void 0:m.data)==null?void 0:e.message)||"載入您的工作時發生錯誤，請稍後再試。";k({text:n,snackbarProps:{color:"error"}}),f.value=!1}finally{p.value=!1}},K=async()=>{var m,e;if(!_.value||!_.value.trim()){k({text:"請輸入邀請訊息",snackbarProps:{color:"warning"}});return}p.value=!0;try{await R.create({targetId:B.params.id,jobId:U.value,message:_.value}),k({text:"邀請已送出！",snackbarProps:{color:"success"}}),f.value=!1,g.value=!0}catch(t){const n=((e=(m=t.response)==null?void 0:m.data)==null?void 0:e.message)||"傳送邀請失敗";n.includes("已邀請")?(k({text:n,snackbarProps:{color:"info"}}),f.value=!1,g.value=!0):k({text:n,snackbarProps:{color:"error"}})}finally{p.value=!1}},O=()=>{M.back()};return X(async()=>{var m,e;S.value=!0;try{const t=B.params.id,{data:n}=await oe.getPublicResumeByUserId(t);n.result?o.value=n.result:I.value="找不到該使用者的履歷，或履歷未公開。"}catch(t){console.error("Failed to fetch resume:",t),I.value=((e=(m=t.response)==null?void 0:m.data)==null?void 0:e.message)||"載入履歷時發生錯誤，請稍後再試。"}finally{S.value=!1}if(P.isLoggedIn)try{const t=B.params.id,{data:n}=await R.checkStatusToUser(t);n.hasBeenInvited&&(g.value=!0)}catch(t){console.error("Failed to check invitation status",t)}}),(m,e)=>(r(),d(ne,null,{default:a(()=>[s(J,{justify:"center"},{default:a(()=>[s(D,{cols:"12",lg:"8",md:"10"},{default:a(()=>[s(V,{class:"mb-4","prepend-icon":"mdi-arrow-left",variant:"text",onClick:O},{default:a(()=>e[6]||(e[6]=[i(" 返回上一頁 ",-1)])),_:1,__:[6]}),S.value?(r(),c("div",ce,[s(z,{color:"primary",indeterminate:"",size:"64"}),e[7]||(e[7]=l("p",{class:"mt-4"},"正在載入履歷...",-1))])):I.value?(r(),d(ie,{key:1,border:"start",prominent:"",type:"error"},{default:a(()=>[e[8]||(e[8]=l("h3",{class:"mb-2"},"載入失敗",-1)),i(" "+u(I.value),1)]),_:1,__:[8]})):o.value?(r(),d(j,{key:2,class:"resume-card",rounded:"lg"},{default:a(()=>[s(J,{"no-gutters":""},{default:a(()=>[s(D,{class:"pa-md-8 pa-5 left-column",cols:"12",md:"4"},{default:a(()=>[o.value.photos&&o.value.photos.length>0?(r(),d(A,{key:0,cycle:"",height:"300","hide-delimiter-background":"","show-arrows":"hover",style:{"border-radius":"8px"}},{default:a(()=>[(r(!0),c(y,null,b(o.value.photos,(t,n)=>(r(),d(E,{key:n},{default:a(()=>[s(F,{class:"fill-height clickable",cover:"",src:t,onClick:$=>q(n)},{default:a(()=>[s(ue,{activator:"parent",location:"center"},{default:a(()=>e[9]||(e[9]=[i("點擊查看大圖",-1)])),_:1,__:[9]})]),_:2},1032,["src","onClick"])]),_:2},1024))),128))]),_:1})):x("",!0),l("div",me,[l("h2",ve,u(o.value.basicInfo.name),1),l("p",fe,u(o.value.basicInfo.age)+" 歲",1),o.value.socialLink?(r(),c("div",pe,[l("a",{class:"social-link",href:o.value.socialLink,rel:"noopener noreferrer",target:"_blank"},[s(L,{small:""},{default:a(()=>e[10]||(e[10]=[i("mdi-link-variant",-1)])),_:1,__:[10]}),e[11]||(e[11]=i(" 社群連結 ",-1))],8,_e)])):x("",!0),s(V,{block:"",class:"mb-4",color:g.value?"success":"primary",disabled:g.value,size:"large",variant:"flat",onClick:H},{default:a(()=>[s(L,{start:""},{default:a(()=>[i(u(g.value?"mdi-check-circle-outline":"mdi-email-send-outline"),1)]),_:1}),i(" "+u(g.value?"已邀請":"邀請換宿"),1)]),_:1},8,["color","disabled"])]),s(G,{class:"my-8"}),e[16]||(e[16]=l("h3",{class:"text-h6 font-weight-bold text-primary mb-4"},"換宿偏好",-1)),l("div",ge,[e[12]||(e[12]=l("h4",{class:"section-title"},"期望換宿地點",-1)),s(h,null,{default:a(()=>[(r(!0),c(y,null,b(o.value.preferences.location,t=>(r(),d(w,{key:t,color:"info",variant:"tonal"},{default:a(()=>[i(u(t),1)]),_:2},1024))),128))]),_:1})]),l("div",ye,[e[13]||(e[13]=l("h4",{class:"section-title"},"期望換宿類型",-1)),s(h,null,{default:a(()=>[(r(!0),c(y,null,b(o.value.hostelType,t=>(r(),d(w,{key:t,color:"success",variant:"tonal"},{default:a(()=>[i(u(t),1)]),_:2},1024))),128))]),_:1})]),l("div",be,[e[14]||(e[14]=l("h4",{class:"section-title"},"期望待遇",-1)),s(h,null,{default:a(()=>[(r(!0),c(y,null,b(o.value.expectedBenefits,t=>(r(),d(w,{key:t,color:"warning",variant:"tonal"},{default:a(()=>[i(u(t),1)]),_:2},1024))),128))]),_:1})]),o.value.preferences&&o.value.preferences.time?(r(),c("div",ke,[e[15]||(e[15]=l("h4",{class:"section-title"},"期望時間",-1)),l("p",xe,u(o.value.preferences.time),1)])):x("",!0)]),_:1,__:[16]}),s(D,{class:"pa-md-8 pa-5",cols:"12",md:"8"},{default:a(()=>[e[22]||(e[22]=l("h3",{class:"text-h5 font-weight-bold text-primary mb-6"},"關於我",-1)),l("div",Ve,[e[17]||(e[17]=l("h4",{class:"section-title"},"學歷",-1)),l("p",he,u(o.value.education),1)]),l("div",we,[e[18]||(e[18]=l("h4",{class:"section-title"},"工作經驗",-1)),l("p",Ie,u(o.value.experience),1)]),l("div",Ce,[e[19]||(e[19]=l("h4",{class:"section-title"},"換宿動機",-1)),l("p",Be,u(o.value.motivation),1)]),s(G,{class:"my-8"}),e[23]||(e[23]=l("h3",{class:"text-h5 font-weight-bold text-primary mb-6"},"我的技能與興趣",-1)),l("div",Pe,[e[20]||(e[20]=l("h4",{class:"section-title"},"語言能力",-1)),s(h,null,{default:a(()=>[(r(!0),c(y,null,b(o.value.languages,t=>(r(),d(w,{key:t,color:"primary",variant:"tonal"},{default:a(()=>[i(u(t),1)]),_:2},1024))),128))]),_:1})]),l("div",Se,[e[21]||(e[21]=l("h4",{class:"section-title"},"興趣",-1)),s(h,null,{default:a(()=>[(r(!0),c(y,null,b(o.value.interests,t=>(r(),d(w,{key:t,color:"secondary",variant:"tonal"},{default:a(()=>[i(u(t),1)]),_:2},1024))),128))]),_:1})])]),_:1,__:[22,23]})]),_:1})]),_:1})):x("",!0)]),_:1})]),_:1}),s(N,{modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=t=>f.value=t),"max-width":"500px"},{default:a(()=>[s(j,null,{default:a(()=>[s(ee,null,{default:a(()=>e[24]||(e[24]=[l("span",{class:"text-h5"},"發送換宿邀請",-1)])),_:1,__:[24]}),s(te,null,{default:a(()=>[o.value?(r(),c("p",Ue,[e[25]||(e[25]=i("您即將邀請 ",-1)),l("strong",Te,u(o.value.basicInfo.name),1)])):x("",!0),p.value&&!U.value?(r(),c("div",je,[s(z,{color:"primary",indeterminate:""}),e[26]||(e[26]=l("p",{class:"mt-2"},"正在準備邀請...",-1))])):(r(),d(de,{key:2,modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=t=>_.value=t),"auto-grow":"",counter:"",label:"邀請訊息",rows:"5",rules:[t=>t&&t.trim().length>0||"訊息不能為空"],variant:"outlined"},null,8,["modelValue","rules"]))]),_:1}),s(ae,null,{default:a(()=>[s(se),s(V,{disabled:p.value,text:"",onClick:e[1]||(e[1]=t=>f.value=!1)},{default:a(()=>e[27]||(e[27]=[i("取消",-1)])),_:1,__:[27]},8,["disabled"]),s(V,{color:"primary",disabled:p.value||!_.value.trim(),loading:p.value,variant:"flat",onClick:K},{default:a(()=>e[28]||(e[28]=[i(" 送出邀請 ",-1)])),_:1,__:[28]},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(N,{modelValue:C.value,"onUpdate:modelValue":e[5]||(e[5]=t=>C.value=t),"max-width":"1200px",width:"auto"},{default:a(()=>[s(j,{rounded:"lg"},{default:a(()=>[s(V,{class:"dialog-close-btn",color:"white",icon:"",size:"x-small",variant:"text",onClick:e[3]||(e[3]=t=>C.value=!1)},{default:a(()=>[s(L,null,{default:a(()=>e[29]||(e[29]=[i("mdi-close",-1)])),_:1,__:[29]})]),_:1}),o.value&&o.value.photos?(r(),d(A,{key:0,modelValue:T.value,"onUpdate:modelValue":e[4]||(e[4]=t=>T.value=t),height:"80vh","hide-delimiters":"","show-arrows":"hover",style:{width:"80vw","max-width":"1200px"}},{default:a(()=>[(r(!0),c(y,null,b(o.value.photos,(t,n)=>(r(),d(E,{key:n},{default:a(()=>[s(F,{contain:"",height:"100%",src:t},null,8,["src"])]),_:2},1024))),128))]),_:1},8,["modelValue"])):x("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},Oe=re(Le,[["__scopeId","data-v-fbed4b4c"]]);export{Oe as default};
