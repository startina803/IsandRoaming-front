import{$ as Q,a0 as W,z as n,l as X,C as Y,ae as Z,ap as ee,a9 as r,a4 as t,a1 as ae,a3 as o,c as a,a2 as L,af as f,b as i,ah as te,a6 as u,ab as d,ag as B,a7 as $,a8 as z,V as S,aj as A,al as le,U as D,ak as w,am as N,aa as g,an as R,au as F}from"./index-BMScu3kp.js";import{a as se}from"./application-B-W_rLEc.js";import{j as oe}from"./job-xIHoAXTT.js";import{_ as re,V as ie,a as ne}from"./_plugin-vue_export-helper-BeEabpYS.js";import{V as ue}from"./VContainer-BdZt_1UG.js";import{V as de}from"./VAlert-MSrvhuEl.js";import{V as M,a as q}from"./VCarouselItem-CQ1gD-u6.js";import{V as me}from"./VTooltip-B5IczYMJ.js";import{V as T}from"./VDivider-1cNt_ePw.js";import{a as h,b as pe,V as ce}from"./VList-uvrgvPMC.js";import{V as fe}from"./VTextarea-B4IxJS1V.js";import"./ssrBoot-BAJjqVjo.js";const ve={key:0,class:"text-center pa-12"},xe=["href"],ge={class:"text-body-1",style:{"white-space":"pre-wrap"}},be={class:"text-body-1",style:{"white-space":"pre-wrap"}},_e={class:"text-body-1",style:{"white-space":"pre-wrap"}},Ve={class:"text-h5 text-primary"},ke={__name:"[id]",setup(ye){const U=Z(),E=ae(),b=Q(),_=W(),s=n(null),C=n(!0),I=n(null),V=n(!1),j=n(0),v=n(!1),x=n(!1),m=n(""),k=n(null),J=X(()=>b.isLoggedIn&&b.identity==="打工換宿者"&&k.value),G=()=>{if(s.value){if(!k.value){_({text:"您需要先建立一份履歷才能應徵",snackbarProps:{color:"warning"}});return}m.value=`您好，我是 ${b.nickname}，我對貴旅宿的「${s.value.title}」換宿工作很有興趣，希望能有機會加入！`,v.value=!0}},H=async()=>{var p,e;if(!m.value||!m.value.trim()){_({text:"請輸入應徵訊息",snackbarProps:{color:"warning"}});return}x.value=!0;try{const{data:l}=await se.create({jobId:U.params.id,message:m.value,resumeId:k.value});_({text:l.message||"應徵成功！",snackbarProps:{color:"success"}}),v.value=!1}catch(l){_({text:((e=(p=l.response)==null?void 0:p.data)==null?void 0:e.message)||"應徵失敗",snackbarProps:{color:"error"}})}finally{x.value=!1}},K=()=>{E.go(-1)},O=p=>{j.value=p,V.value=!0};return Y(async()=>{const p=U.params.id;C.value=!0;try{const e=oe.getPublicJobById(p),l=b.isLoggedIn?ee.profile():Promise.resolve(null),[c,y]=await Promise.all([e,l]);if(s.value=c.data.result,y&&y.data.success){const P=y.data.user.resumes;P&&P.length>0&&(k.value=P[0])}}catch(e){console.error("Failed to fetch job details or user profile:",e),I.value="無法載入頁面，請稍後再試。"}finally{C.value=!1}}),(p,e)=>(o(),r(ue,null,{default:t(()=>[a(ie,{justify:"center"},{default:t(()=>[a(ne,{cols:"12",md:"8"},{default:t(()=>[C.value?(o(),L("div",ve,[a(te,{color:"primary",indeterminate:"",size:"64"}),e[6]||(e[6]=i("p",{class:"mt-4"},"正在載入工作詳情...",-1))])):I.value?(o(),r(de,{key:1,border:"start",prominent:"",type:"error"},{default:t(()=>[e[7]||(e[7]=i("h3",{class:"mb-2"},"載入失敗",-1)),u(" "+d(I.value),1)]),_:1,__:[7]})):s.value?(o(),r(B,{key:2,class:"mx-auto job-detail-card",rounded:"lg"},{default:t(()=>[s.value.photos&&s.value.photos.length>0?(o(),r(M,{key:0,cycle:"",height:"300","hide-delimiter-background":"","show-arrows":"hover"},{default:t(()=>[(o(!0),L($,null,z(s.value.photos,(l,c)=>(o(),r(q,{key:c},{default:t(()=>[a(S,{class:"fill-height clickable",cover:"",src:l,onClick:y=>O(c)},{default:t(()=>[a(me,{activator:"parent",location:"center"},{default:t(()=>e[8]||(e[8]=[u("點擊查看大圖",-1)])),_:1,__:[8]})]),_:2},1032,["src","onClick"])]),_:2},1024))),128))]),_:1})):(o(),r(S,{key:1,cover:"",height:"300px",src:"https://cdn.vuetifyjs.com/images/cards/docks.jpg"})),a(A,{class:"text-h4 text-primary mt-4 mb-2 px-md-8 px-4"},{default:t(()=>[u(d(s.value.title),1)]),_:1}),a(le,{class:"px-md-8 px-4"},{default:t(()=>[a(D,{class:"mr-1",icon:"mdi-map-marker"}),u(" "+d(s.value.detailedLocation||s.value.location),1)]),_:1}),a(T,{class:"my-6 mx-md-8 mx-4 orange-divider"}),a(h,{class:"px-md-8 px-4"},{default:t(()=>[a(pe,{class:"text-h6 font-weight-bold text-primary"},{default:t(()=>e[9]||(e[9]=[u("換宿資訊",-1)])),_:1,__:[9]})]),_:1}),a(ce,{class:"py-0 px-md-8 px-4",density:"compact"},{default:t(()=>[a(h,{"prepend-icon":"mdi-calendar-clock",subtitle:s.value.workPeriod||"未提供",title:"換宿期間"},null,8,["subtitle"]),a(h,{"prepend-icon":"mdi-account-group",subtitle:s.value.requiredPeopleCount||"未提供",title:"需求人數"},null,8,["subtitle"]),s.value.socialLink?(o(),r(h,{key:0,"prepend-icon":"mdi-link-variant",title:"相關連結"},{subtitle:t(()=>[i("a",{href:s.value.socialLink,rel:"noopener noreferrer",target:"_blank"},d(s.value.socialLink),9,xe)]),_:1})):f("",!0)]),_:1}),a(T,{class:"my-6 mx-md-8 mx-4 orange-divider"}),s.value.workContent?(o(),r(w,{key:2,class:"px-md-8 px-4"},{default:t(()=>[e[10]||(e[10]=i("div",{class:"text-h6 font-weight-bold mb-2 text-primary"},"工作內容",-1)),i("p",ge,d(s.value.workContent),1)]),_:1,__:[10]})):f("",!0),s.value.helperBenefits?(o(),r(w,{key:3,class:"px-md-8 px-4"},{default:t(()=>[e[11]||(e[11]=i("div",{class:"text-h6 font-weight-bold mb-2 text-primary"},"小幫手福利",-1)),i("p",be,d(s.value.helperBenefits),1)]),_:1,__:[11]})):f("",!0),s.value.notes?(o(),r(w,{key:4,class:"px-md-8 px-4"},{default:t(()=>[e[12]||(e[12]=i("div",{class:"text-h6 font-weight-bold mb-2 text-primary"},"注意事項",-1)),i("p",_e,d(s.value.notes),1)]),_:1,__:[12]})):f("",!0),a(T,{class:"mt-6 mb-2 mx-md-8 mx-4 orange-divider"}),a(N,{class:"px-md-8 px-4 pt-4 pb-6"},{default:t(()=>[a(g,{class:"back-btn",icon:"mdi-arrow-left",size:"default",variant:"text",onClick:K}),a(R),J.value?(o(),r(g,{key:0,color:"#ea914e",size:"large",variant:"flat",width:"250",onClick:G},{default:t(()=>e[13]||(e[13]=[u(" 立即應徵 ",-1)])),_:1,__:[13]})):f("",!0),a(R)]),_:1})]),_:1})):f("",!0)]),_:1})]),_:1}),a(F,{modelValue:V.value,"onUpdate:modelValue":e[2]||(e[2]=l=>V.value=l),"max-width":"1200px",width:"auto"},{default:t(()=>[a(B,{rounded:"lg"},{default:t(()=>[a(g,{class:"dialog-close-btn",color:"#ea914e",icon:"",size:"x-small",onClick:e[0]||(e[0]=l=>V.value=!1)},{default:t(()=>[a(D,null,{default:t(()=>e[14]||(e[14]=[u("mdi-close",-1)])),_:1,__:[14]})]),_:1}),a(M,{modelValue:j.value,"onUpdate:modelValue":e[1]||(e[1]=l=>j.value=l),height:"80vh","hide-delimiters":"","show-arrows":"hover",style:{width:"80vw","max-width":"1200px"}},{default:t(()=>[(o(!0),L($,null,z(s.value.photos,(l,c)=>(o(),r(q,{key:c},{default:t(()=>[a(S,{contain:"",height:"100%",src:l},null,8,["src"])]),_:2},1024))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),a(F,{modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=l=>v.value=l),"max-width":"600px",persistent:""},{default:t(()=>[a(B,null,{default:t(()=>[a(A,null,{default:t(()=>{var l;return[i("span",Ve,"應徵工作："+d((l=s.value)==null?void 0:l.title),1)]}),_:1}),a(w,null,{default:t(()=>[e[15]||(e[15]=i("p",{class:"mb-4"},"您即將向旅宿業者送出您的應徵申請。",-1)),a(fe,{modelValue:m.value,"onUpdate:modelValue":e[3]||(e[3]=l=>m.value=l),"bg-color":"orange-lighten-5",color:"orange-darken-2","auto-grow":"",counter:"",label:"想對旅宿業者說的話",placeholder:"簡單介紹一下自己，並說明為什麼想應徵這份工作吧！",rows:"5",rules:[l=>l&&l.trim().length>0||"訊息不能為空"],variant:"outlined"},null,8,["modelValue","rules"])]),_:1,__:[15]}),a(N,null,{default:t(()=>[a(R),a(g,{disabled:x.value,text:"",onClick:e[4]||(e[4]=l=>v.value=!1)},{default:t(()=>e[16]||(e[16]=[u("取消",-1)])),_:1,__:[16]},8,["disabled"]),a(g,{color:"orange-darken-2",disabled:x.value||!m.value.trim(),loading:x.value,variant:"flat",onClick:H},{default:t(()=>e[17]||(e[17]=[u(" 送出應徵 ",-1)])),_:1,__:[17]},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},$e=re(ke,[["__scopeId","data-v-4c2f1abf"]]);export{$e as default};
